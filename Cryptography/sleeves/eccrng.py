

# This file was *autogenerated* from the file eccrng.sage
from sage.all_cmdline import *   # import sage library

_sage_const_115792089210356248762697446949407573530086143415290314195533631308867097853951 = Integer(115792089210356248762697446949407573530086143415290314195533631308867097853951); _sage_const_0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b = Integer(0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b); _sage_const_3 = Integer(3); _sage_const_110498562485703529190272711232043142138878635567672718436939544261168672750412 = Integer(110498562485703529190272711232043142138878635567672718436939544261168672750412); _sage_const_67399507399944999831532913043433949950487143475898523797536613673733894036166 = Integer(67399507399944999831532913043433949950487143475898523797536613673733894036166); _sage_const_1 = Integer(1); _sage_const_2 = Integer(2); _sage_const_256 = Integer(256); _sage_const_0 = Integer(0); _sage_const_8 = Integer(8)
from random import randint

class RNG:
    def __init__(self):
        p = _sage_const_115792089210356248762697446949407573530086143415290314195533631308867097853951 
        b = _sage_const_0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b 

        self.curve = EllipticCurve(GF(p), [-_sage_const_3 ,b])
        self.P = self.curve.lift_x(_sage_const_110498562485703529190272711232043142138878635567672718436939544261168672750412 )
        self.Q = self.curve.lift_x(_sage_const_67399507399944999831532913043433949950487143475898523797536613673733894036166 )
        self.state = randint(_sage_const_1 , _sage_const_2 **_sage_const_256 )

    def next(self):
        sP = self.state*self.P
        r = Integer(sP[_sage_const_0 ])
        self.state = Integer((r*self.P)[_sage_const_0 ])
        rQ = r*self.Q
        return Integer(rQ[_sage_const_0 ])>>_sage_const_8 

